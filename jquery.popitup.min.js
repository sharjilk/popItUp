!function(o){o.fn.popitup=function(e){function t(){$modal.css({left:"50%",bottom:"",right:""})}var a={widthSet:"",overlayColor:"#000",overlayOpacity:"0.5",autoClose:!1,animation:null,colorChange:{color:null,background:null},chase:!0,chaseSpeed:"500",fixedModal:!1,modalPosition:[],containerToLoad:"",urlToLoad:"",imageToLoad:"",onCloseModal:function(){},onOpenModal:function(){}},i=o.extend(!0,{},a,e),l=/^[0-9]/,n=/^[0-1][.][0-9]$/,s=/^[#][A-Fa-f0-9]/;if(o.each(i,function(o,e){"widthSet"===o&&null===e.match(l)&&(i[o]=a[o]),"overlayColor"===o&&null===e.match(s)&&(i[o]=a[o]),"overlayOpacity"==o&&null===e.match(n)&&(i[o]=a[o]),"autoClose"===o&&e!==!0&&(i[o]=a[o]),"chase"===o&&e!==!1&&(i[o]=a[o]),"fixedModal"===o&&e!==!0&&(i[o]=a[o]),"modalPosition"===o&&i.modalPosition.length>0&&(i.chase=!1)}),$modal=this,o("body").append('<div class="popitup-overlay"></div>'),o(".popitup-overlay").css({background:i.overlayColor,opacity:i.overlayOpacity}),i.fixedModal)var d="fixed";else d="absolute";if($modal.css({width:i.widthSet+"px",position:d,display:"block",opacity:"0","z-index":"99999"}),""!=i.containerToLoad){if(""!=i.urlToLoad){var p;p=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),p.open("GET",i.urlToLoad),p.readyState>0&&o(i.containerToLoad).load(i.urlToLoad),p.send()}""!=i.imageToLoad&&(o(i.containerToLoad).html("<img src='' class='popitup-img' />"),o(".popitup-img").attr("src",i.imageToLoad))}if($margin_left=$modal.outerWidth()/2,$margin_top=$modal.outerHeight()/2,$modal.css({"margin-top":"-"+$margin_top+"px","margin-left":"-"+$margin_left+"px"}),i.modalPosition.length>0)$modal.css({top:o(window).scrollTop()+i.modalPosition[0],left:i.modalPosition[1],margin:0,opacity:"1",position:"absolute"});else switch(i.animation){case"slideDown":$modal.css("top","0").animate({top:o(window).height()/2+o(window).scrollTop()+"px",opacity:"1"},300),t();break;case"slideUp":$modal.css("bottom","0").animate({top:o(window).height()/2+o(window).scrollTop()+"px",opacity:"1"},300),t();break;case"slideLeft":$modal.css({left:"0",top:o(window).height()/2+o(window).scrollTop()+"px"}).animate({left:"50%",opacity:"1"},300),t();break;case"slideRight":$modal.css({right:"0",top:(o(window).height()+o(window).scrollTop())/2+"px"}).animate({left:"50%",opacity:"1"},300),t();break;default:$modal.css({top:o(window).height()/2+o(window).scrollTop()+"px",opacity:"1"}),t()}if(i.onOpenModal(),i.autoClose&&o(".popitup-overlay").bind("click",function(){if(i.modalPosition.length>0)$modal.css({top:"",left:"",right:"",bottom:""}).hide(),o(".popitup-overlay").remove();else switch(i.animation){case"slideDown":$modal.animate({top:"0",opacity:"0",display:"none"},300),t(),setTimeout(function(){$modal.removeAttr("style")},300);break;case"slideUp":$modal.animate({top:"100%",opacity:"0",display:"none"},300),t(),setTimeout(function(){$modal.removeAttr("style")},300);break;case"slideLeft":$modal.animate({left:"0",opacity:"0",display:"none"},300),t(),setTimeout(function(){$modal.removeAttr("style")},300);break;case"slideRight":$modal.animate({left:"100%",opacity:"0",display:"none"},300),t(),setTimeout(function(){$modal.removeAttr("style")},300);break;default:$modal.removeAttr("style").hide(),o(".popitup-overlay").remove()}setTimeout(function(){o(".popitup-overlay").remove()},300),i.onCloseModal()}),!i.fixedModal&&i.chase===!0){var c=0;o(window).scroll(function(e){var t=o(this).scrollTop();t>c?$modal.stop().animate({top:o(window).height()/2+o(window).scrollTop()+"px"},+i.chaseSpeed):$modal.stop().animate({top:o(window).height()/2+o(window).scrollTop()+"px"},+i.chaseSpeed),c=t})}return o("*").each(function(){$varClose=o(this).hasClass("popitup-close"),$varClose&&o(this).bind("click",function(){if(i.modalPosition.length>0)$modal.css({top:"",left:"",right:"",bottom:""}).hide(),o(".popitup-overlay").remove();else switch(i.animation){case"slideDown":$modal.animate({top:"0",opacity:"0",display:"none"},300),t(),setTimeout(function(){$modal.removeAttr("style")},300);break;case"slideUp":$modal.animate({top:"100%",opacity:"0",display:"none"},300),t(),setTimeout(function(){$modal.removeAttr("style")},300);break;case"slideLeft":$modal.animate({left:"0",opacity:"0",display:"none"},300),t(),setTimeout(function(){$modal.removeAttr("style")},300);break;case"slideRight":$modal.animate({left:"100%",opacity:"0",display:"none"},300),t(),setTimeout(function(){$modal.removeAttr("style")},300);break;default:$modal.removeAttr("style").hide(),o(".popitup-overlay").remove()}setTimeout(function(){o(".popitup-overlay").remove()},300),i.onCloseModal.call()})}),i.colorChange&&$modal.css({color:i.colorChange.color,background:i.colorChange.background}),$modal}}(jQuery);
